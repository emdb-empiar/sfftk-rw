

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Developing with sfftk-rw &mdash; sfftkrw v0.5.0.dev0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="sfftk packages" href="sfftk-rw.html" />
    <link rel="prev" title="Miscellaneous Operations Using sfftk-rw" href="misc.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> sfftkrw
          

          
          </a>

          
            
            
              <div class="version">
                v0.5
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="toolkit.html">EMDB-SFF Read/Write Toolkit (<code class="docutils literal notranslate"><span class="pre">sfftk-rw</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="converting.html">Converting Files To EMDB-SFF</a></li>
<li class="toctree-l1"><a class="reference internal" href="misc.html">Miscellaneous Operations Using sfftk-rw</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Developing with <code class="docutils literal notranslate"><span class="pre">sfftk-rw</span></code></a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#reading-emdb-sff-files">Reading EMDB-SFF Files</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#viewing-segmentation-metadata">Viewing Segmentation Metadata</a></li>
<li class="toctree-l3"><a class="reference internal" href="#viewing-segments">Viewing Segments</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#getting-the-list-of-segment-ids">Getting The List of Segment IDs</a></li>
<li class="toctree-l4"><a class="reference internal" href="#getting-a-segment-by-id">Getting A Segment By ID</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#viewing-segment-metadata">Viewing Segment Metadata</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id-and-parent-id">ID and Parent ID</a></li>
<li class="toctree-l4"><a class="reference internal" href="#biological-annotation">Biological Annotation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#complexes-and-macromolecules">Complexes and Macromolecules</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#creating-emdb-sff-objects">Creating EMDB-SFF Objects</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#setting-segmentation-metadata">Setting Segmentation Metadata</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#setting-segments">Setting Segments</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#exporting-emdb-sff-objects">Exporting EMDB-SFF Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="#navigating-your-way-through-a-segmentation">Navigating Your Way Through A Segmentation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#iterating">Iterating</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#segments">Segments</a></li>
<li class="toctree-l4"><a class="reference internal" href="#meshes">Meshes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#external-references">External References</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="sfftk-rw.html">sfftk packages</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">sfftkrw</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Developing with <code class="docutils literal notranslate"><span class="pre">sfftk-rw</span></code></li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/developing.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="developing-with-sfftk-rw">
<h1><a class="toc-backref" href="#id3">Developing with <code class="docutils literal notranslate"><span class="pre">sfftk-rw</span></code></a><a class="headerlink" href="#developing-with-sfftk-rw" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#developing-with-sfftk-rw" id="id3">Developing with <code class="docutils literal notranslate"><span class="pre">sfftk-rw</span></code></a></p>
<ul>
<li><p><a class="reference internal" href="#introduction" id="id4">Introduction</a></p></li>
<li><p><a class="reference internal" href="#reading-emdb-sff-files" id="id5">Reading EMDB-SFF Files</a></p>
<ul>
<li><p><a class="reference internal" href="#viewing-segmentation-metadata" id="id6">Viewing Segmentation Metadata</a></p></li>
<li><p><a class="reference internal" href="#viewing-segments" id="id7">Viewing Segments</a></p>
<ul>
<li><p><a class="reference internal" href="#getting-the-list-of-segment-ids" id="id8">Getting The List of Segment IDs</a></p></li>
<li><p><a class="reference internal" href="#getting-a-segment-by-id" id="id9">Getting A Segment By ID</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#viewing-segment-metadata" id="id10">Viewing Segment Metadata</a></p>
<ul>
<li><p><a class="reference internal" href="#id-and-parent-id" id="id11">ID and Parent ID</a></p></li>
<li><p><a class="reference internal" href="#biological-annotation" id="id12">Biological Annotation</a></p></li>
<li><p><a class="reference internal" href="#complexes-and-macromolecules" id="id13">Complexes and Macromolecules</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#creating-emdb-sff-objects" id="id14">Creating EMDB-SFF Objects</a></p>
<ul>
<li><p><a class="reference internal" href="#setting-segmentation-metadata" id="id15">Setting Segmentation Metadata</a></p>
<ul>
<li><p><a class="reference internal" href="#setting-segments" id="id16">Setting Segments</a></p>
<ul>
<li><p><a class="reference internal" href="#setting-segment-metadata" id="id17">Setting Segment Metadata</a></p>
<ul>
<li><p><a class="reference internal" href="#id1" id="id18">Biological Annotation</a></p></li>
<li><p><a class="reference internal" href="#id2" id="id19">Complexes and Macromolecules</a></p></li>
<li><p><a class="reference internal" href="#colour" id="id20">Colour</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#setting-mesh-segments" id="id21">Setting Mesh Segments</a></p></li>
<li><p><a class="reference internal" href="#setting-shape-segments" id="id22">Setting Shape Segments</a></p></li>
<li><p><a class="reference internal" href="#setting-volume-segments" id="id23">Setting Volume Segments</a></p></li>
<li><p><a class="reference internal" href="#adding-a-segment-to-the-segmentation" id="id24">Adding A Segment To The Segmentation</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#exporting-emdb-sff-objects" id="id25">Exporting EMDB-SFF Objects</a></p></li>
<li><p><a class="reference internal" href="#navigating-your-way-through-a-segmentation" id="id26">Navigating Your Way Through A Segmentation</a></p>
<ul>
<li><p><a class="reference internal" href="#iterating" id="id27">Iterating</a></p>
<ul>
<li><p><a class="reference internal" href="#segments" id="id28">Segments</a></p></li>
<li><p><a class="reference internal" href="#meshes" id="id29">Meshes</a></p></li>
<li><p><a class="reference internal" href="#external-references" id="id30">External References</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="introduction">
<h2><a class="toc-backref" href="#id4">Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">sfftk-rw</span></code> has been designed to be relatively straightforward to integrate into other Python applications because it
has been designed in such a way that the various components are independent of one another.</p>
<p>The main components of the package are:</p>
<ul class="simple">
<li><p>the <strong>adapter</strong> API (<a class="reference internal" href="schema.html#module-sfftkrw.schema.adapter" title="sfftkrw.schema.adapter"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sfftkrw.schema.adapter</span></code></a>) which handles how data fields are represented independent of
the file formats to be used (XML, HDF5 and JSON). This package provides an adapter to the underlying
<a class="reference external" href="https://www.davekuhlman.org/generateDS.html">GenerateDS</a> API which <em>extends</em> and <em>simplifies</em> EMDB-SFF fields.</p></li>
<li><p>the <strong>core</strong> API (<code class="xref py py-mod docutils literal notranslate"><span class="pre">sfftkrw.core</span></code>) provides a set of useful utilities mainly for the command-line toolkit
(<code class="docutils literal notranslate"><span class="pre">sff</span></code> command) that handle command line arguments (making sure that they have the right values) and miscellaneous
utilities.</p></li>
</ul>
</div>
<div class="section" id="reading-emdb-sff-files">
<h2><a class="toc-backref" href="#id5">Reading EMDB-SFF Files</a><a class="headerlink" href="#reading-emdb-sff-files" title="Permalink to this headline">¶</a></h2>
<p>All aspects of the structure of an EMDB-SFF file are handled by <a class="reference internal" href="schema.html#module-sfftkrw.schema.adapter" title="sfftkrw.schema.adapter"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sfftkrw.schema.adapter</span></code></a> package which
defines the <a class="reference internal" href="schema.html#sfftkrw.schema.adapter.SFFSegmentation" title="sfftkrw.schema.adapter.SFFSegmentation"><code class="xref py py-class docutils literal notranslate"><span class="pre">sfftkrw.schema.adapter.SFFSegmentation</span></code></a> class to handle reading, creation and writing of
EMDB-SFF files. Please consult the section on <a class="reference internal" href="converting.html#output-formats"><span class="std std-ref">Output Formats</span></a> for background information.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sfftkrw.schema.adapter</span> <span class="kn">import</span> <span class="n">SFFSegmentation</span>
<span class="kn">from</span> <span class="nn">sfftkrw.unittests</span> <span class="kn">import</span> <span class="n">TEST_DATA_PATH</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># XML file</span>
<span class="n">seg_fn</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">TEST_DATA_PATH</span><span class="p">,</span> <span class="s1">&#39;sff&#39;</span><span class="p">,</span> <span class="s1">&#39;v0.7&#39;</span><span class="p">,</span> <span class="s1">&#39;emd_1014.sff&#39;</span><span class="p">)</span>
<span class="n">seg_fn</span>
<span class="s1">&#39;/Users/pkorir/PycharmProjects/sfftk-rw/sfftkrw/test_data/sff/v0.7/emd_1014.sff&#39;</span>
<span class="n">seg</span> <span class="o">=</span> <span class="n">SFFSegmentation</span><span class="p">(</span><span class="n">seg_fn</span><span class="p">)</span>

<span class="c1"># HDF5 file</span>
<span class="n">seg_fn</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">TEST_DATA_PATH</span><span class="p">,</span> <span class="s1">&#39;sff&#39;</span><span class="p">,</span> <span class="s1">&#39;v0.7&#39;</span><span class="p">,</span> <span class="s1">&#39;emd_1014.hff&#39;</span><span class="p">)</span>
<span class="n">seg</span> <span class="o">=</span> <span class="n">SFFSegmentation</span><span class="p">(</span><span class="n">seg_fn</span><span class="p">)</span>

<span class="c1"># JSON file</span>
<span class="n">seg_fn</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">TEST_DATA_PATH</span><span class="p">,</span> <span class="s1">&#39;sff&#39;</span><span class="p">,</span> <span class="s1">&#39;v0.7&#39;</span><span class="p">,</span> <span class="s1">&#39;emd_1014.json&#39;</span><span class="p">)</span>
<span class="n">seg</span> <span class="o">=</span> <span class="n">SFFSegmentation</span><span class="p">(</span><span class="n">seg_fn</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">sfftkrw.unittests</span> <span class="kn">import</span> <span class="n">TEST_DATA_PATH</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># XML file</span>
<span class="n">seg_fn</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">TEST_DATA_PATH</span><span class="p">,</span> <span class="s1">&#39;sff&#39;</span><span class="p">,</span> <span class="s1">&#39;v0.7&#39;</span><span class="p">,</span> <span class="s1">&#39;emd_1014.sff&#39;</span><span class="p">)</span>
<span class="n">seg_fn</span>
<span class="s1">&#39;/Users/pkorir/PycharmProjects/sfftk-rw/sfftkrw/test_data/sff/v0.7/emd_1014.sff&#39;</span>
<span class="n">seg</span> <span class="o">=</span> <span class="n">SFFSegmentation</span><span class="p">(</span><span class="n">seg_fn</span><span class="p">)</span>

<span class="c1"># HDF5 file</span>
<span class="n">seg_fn</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">TEST_DATA_PATH</span><span class="p">,</span> <span class="s1">&#39;sff&#39;</span><span class="p">,</span> <span class="s1">&#39;v0.7&#39;</span><span class="p">,</span> <span class="s1">&#39;emd_1014.hff&#39;</span><span class="p">)</span>
<span class="n">seg</span> <span class="o">=</span> <span class="n">SFFSegmentation</span><span class="p">(</span><span class="n">seg_fn</span><span class="p">)</span>

<span class="c1"># JSON file</span>
<span class="n">seg_fn</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">TEST_DATA_PATH</span><span class="p">,</span> <span class="s1">&#39;sff&#39;</span><span class="p">,</span> <span class="s1">&#39;v0.7&#39;</span><span class="p">,</span> <span class="s1">&#39;emd_1014.json&#39;</span><span class="p">)</span>
<span class="n">seg</span> <span class="o">=</span> <span class="n">SFFSegmentation</span><span class="p">(</span><span class="n">seg_fn</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="viewing-segmentation-metadata">
<h3><a class="toc-backref" href="#id6">Viewing Segmentation Metadata</a><a class="headerlink" href="#viewing-segmentation-metadata" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>from __future__ import print_function
from sfftkrw.schema.adapter import SFFSegmentation
from sfftkrw.unittests import TEST_DATA_PATH
import os
# XML file
seg_fn = os.path.join(TEST_DATA_PATH, &#39;annotated_sff&#39;, &#39;v0.7&#39;, &#39;emd_6338.sff&#39;)
seg = SFFSegmentation(seg_fn)

# name
print(seg.name)
Segger Segmentation

# schema version
print(seg.version)
0.7.0.dev0

# software details
... print(seg.software)
Software object

# primary descriptor
print(seg.primary_descriptor)
threeDVolume

# transforms
print(seg.transforms)
List of transforms
print(len(seg.transforms))
2
print(seg.transforms[0])
[1.0000 0.0000 0.0000 1.0000 ]
[0.0000 1.0000 0.0000 1.0000 ]
[0.0000 0.0000 1.0000 1.0000 ]


# bounding box
print(seg.bounding_box)
Bounding box: (0.0, None, 0.0, None, 0.0, None)

# details
print(seg.details)
DNA replication in eukaryotes is strictly regulated by several mechanisms. A central step in this replication is the assembly of the heterohexameric minichromosome maintenance (MCM2-7) helicase complex at replication origins during G1 phase as an inactive double hexamer. Here, using cryo-electron microscopy, we report a near-atomic structure of the MCM2-7 double hexamer purified from yeast G1 chromatin. Our structure shows that two single hexamers, arranged in a tilted and twisted fashion through interdigitated amino-terminal domain interactions, form a kinked central channel. Four constricted rings consisting of conserved interior β-hairpins from the two single hexamers create a narrow passageway that tightly fits duplex DNA. This narrow passageway, reinforced by the offset of the two single hexamers at the double hexamer interface, is flanked by two pairs of gate-forming subunits, MCM2 and MCM5. These unusual features of the twisted and tilted single hexamers suggest a concerted mechanism for the melting of origin DNA that requires structural deformation of the intervening DNA.

from sfftkrw.schema.adapter.adapter import SFFSegmentation
from sfftkrw.unittests import TEST_DATA_PATH
import os
# XML file
seg_fn = os.path.join(TEST_DATA_PATH, &#39;annotated_sff&#39;, &#39;v0.7&#39;, &#39;emd_6338.sff&#39;)
seg = SFFSegmentation(seg_fn)

# name
print(seg.name)
Segger Segmentation

# schema version
print(seg.version)
0.7.0.dev0

# software details
... print(seg.software)
Software object

# primary descriptor
print(seg.primary_descriptor)
threeDVolume

# transforms
print(seg.transforms)
List of transforms
print(len(seg.transforms))
2
print(seg.transforms[0])
[1.0000 0.0000 0.0000 1.0000 ]
[0.0000 1.0000 0.0000 1.0000 ]
[0.0000 0.0000 1.0000 1.0000 ]


# bounding box
print(seg.bounding_box)
Bounding box: (0.0, None, 0.0, None, 0.0, None)

# details
print(seg.details)
DNA replication in eukaryotes is strictly regulated by several mechanisms. A central step in this replication is the assembly of the heterohexameric minichromosome maintenance (MCM2-7) helicase complex at replication origins during G1 phase as an inactive double hexamer. Here, using cryo-electron microscopy, we report a near-atomic structure of the MCM2-7 double hexamer purified from yeast G1 chromatin. Our structure shows that two single hexamers, arranged in a tilted and twisted fashion through interdigitated amino-terminal domain interactions, form a kinked central channel. Four constricted rings consisting of conserved interior β-hairpins from the two single hexamers create a narrow passageway that tightly fits duplex DNA. This narrow passageway, reinforced by the offset of the two single hexamers at the double hexamer interface, is flanked by two pairs of gate-forming subunits, MCM2 and MCM5. These unusual features of the twisted and tilted single hexamers suggest a concerted mechanism for the melting of origin DNA that requires structural deformation of the intervening DNA.
</pre></div>
</div>
</div>
<div class="section" id="viewing-segments">
<h3><a class="toc-backref" href="#id7">Viewing Segments</a><a class="headerlink" href="#viewing-segments" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">segments</span><span class="p">)</span>
<span class="n">Segment</span> <span class="n">container</span>
</pre></div>
</div>
<div class="section" id="getting-the-list-of-segment-ids">
<h4><a class="toc-backref" href="#id8">Getting The List of Segment IDs</a><a class="headerlink" href="#getting-the-list-of-segment-ids" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># segment IDs</span>
<span class="k">print</span><span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">segments</span><span class="o">.</span><span class="n">get_ids</span><span class="p">())</span>
<span class="p">[</span><span class="mi">9952</span><span class="p">,</span> <span class="mi">9859</span><span class="p">,</span> <span class="mi">9764</span><span class="p">,</span> <span class="mi">9893</span><span class="p">,</span> <span class="mi">9897</span><span class="p">,</span> <span class="mi">9911</span><span class="p">,</span> <span class="mi">9840</span><span class="p">,</span> <span class="mi">9955</span><span class="p">,</span> <span class="mi">9814</span><span class="p">,</span> <span class="mi">9815</span><span class="p">,</span> <span class="mi">9956</span><span class="p">,</span> <span class="mi">9914</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="getting-a-segment-by-id">
<h4><a class="toc-backref" href="#id9">Getting A Segment By ID</a><a class="headerlink" href="#getting-a-segment-by-id" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">segment</span> <span class="o">=</span> <span class="n">seg</span><span class="o">.</span><span class="n">segments</span><span class="o">.</span><span class="n">get_by_id</span><span class="p">(</span><span class="mi">9911</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">segment</span><span class="p">)</span>
<span class="n">SFFSegment</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="viewing-segment-metadata">
<h3><a class="toc-backref" href="#id10">Viewing Segment Metadata</a><a class="headerlink" href="#viewing-segment-metadata" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id-and-parent-id">
<h4><a class="toc-backref" href="#id11">ID and Parent ID</a><a class="headerlink" href="#id-and-parent-id" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">segment</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<span class="mi">9911</span>
<span class="c1"># Every segment is a child of the root segment with parentID = 0</span>
<span class="k">print</span><span class="p">(</span><span class="n">segment</span><span class="o">.</span><span class="n">parent_id</span><span class="p">)</span>
<span class="mi">0</span>
</pre></div>
</div>
</div>
<div class="section" id="biological-annotation">
<h4><a class="toc-backref" href="#id12">Biological Annotation</a><a class="headerlink" href="#biological-annotation" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">segment</span><span class="o">.</span><span class="n">biological_annotation</span><span class="p">)</span>
<span class="n">Container</span> <span class="k">for</span> <span class="n">biological</span> <span class="n">annotation</span> <span class="k">with</span> <span class="mi">2</span> <span class="n">external</span> <span class="n">references</span>

<span class="k">print</span><span class="p">(</span><span class="n">segment</span><span class="o">.</span><span class="n">biological_annotation</span><span class="o">.</span><span class="n">description</span><span class="p">)</span>
<span class="n">DNA</span> <span class="n">replication</span> <span class="n">licensing</span> <span class="n">factor</span> <span class="n">MCM7</span>

<span class="k">print</span><span class="p">(</span><span class="n">segment</span><span class="o">.</span><span class="n">biological_annotation</span><span class="o">.</span><span class="n">numberOfInstances</span><span class="p">)</span>
<span class="mi">1</span>

<span class="k">print</span><span class="p">(</span><span class="n">segment</span><span class="o">.</span><span class="n">biological_annotation</span><span class="o">.</span><span class="n">externalReferences</span><span class="p">)</span>
<span class="n">External</span> <span class="n">references</span> <span class="nb">list</span> <span class="k">with</span> <span class="mi">2</span> <span class="n">reference</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">segment</span><span class="o">.</span><span class="n">biological_annotation</span><span class="o">.</span><span class="n">externalReferences</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># first reference</span>
<span class="n">Reference</span><span class="p">:</span> <span class="n">pr</span><span class="p">;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">purl</span><span class="o">.</span><span class="n">obolibrary</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">obo</span><span class="o">/</span><span class="n">PR_P38132</span><span class="p">;</span> <span class="n">PR_P38132</span>
</pre></div>
</div>
</div>
<div class="section" id="complexes-and-macromolecules">
<h4><a class="toc-backref" href="#id13">Complexes and Macromolecules</a><a class="headerlink" href="#complexes-and-macromolecules" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">segment</span><span class="o">.</span><span class="n">complexes_and_macromolecules</span><span class="p">)</span>
<span class="n">Complexes</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span> <span class="n">Macromolecules</span><span class="p">:</span> <span class="mi">0</span>

<span class="k">print</span><span class="p">(</span><span class="n">segment</span><span class="o">.</span><span class="n">complexes_and_macromolecules</span><span class="o">.</span><span class="n">complexes</span><span class="p">)</span>
<span class="n">Complex</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">length</span> <span class="mi">0</span>

<span class="k">print</span><span class="p">(</span><span class="n">segment</span><span class="o">.</span><span class="n">complexes_and_macromolecules</span><span class="o">.</span><span class="n">macromolecules</span><span class="p">)</span>
<span class="n">Macromolecule</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">length</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="creating-emdb-sff-objects">
<h2><a class="toc-backref" href="#id14">Creating EMDB-SFF Objects</a><a class="headerlink" href="#creating-emdb-sff-objects" title="Permalink to this headline">¶</a></h2>
<p>Users can create EMDB-SFF objects from scratch then export them to a file format of your choice.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
    <span class="kn">from</span> <span class="nn">sfftkrw</span> <span class="kn">import</span> <span class="n">schema</span>
    <span class="kn">import</span> <span class="nn">sys</span>
    <span class="n">seg</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">SFFSegmentation</span><span class="p">()</span>

    <span class="c1"># We can view how the file looks like so far; note the lack of an XML header &lt;?xml ...&gt;</span>
    <span class="n">seg</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
    <span class="o">&lt;</span><span class="n">segmentation</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">version</span><span class="o">&gt;</span><span class="mf">0.7</span><span class="o">.</span><span class="mf">0.</span><span class="n">dev0</span><span class="o">&lt;/</span><span class="n">version</span><span class="o">&gt;</span>
    <span class="o">&lt;/</span><span class="n">segmentation</span><span class="o">&gt;</span>
<span class="kn">from</span> <span class="nn">sfftkrw.schema</span> <span class="kn">import</span> <span class="n">adapter</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="n">seg</span> <span class="o">=</span> <span class="n">adapter</span><span class="o">.</span><span class="n">SFFSegmentation</span><span class="p">()</span>

<span class="c1"># We can view how the file looks like so far; note the lack of an XML header &lt;?xml ...&gt;</span>
<span class="n">seg</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
<span class="o">&lt;</span><span class="n">segmentation</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">version</span><span class="o">&gt;</span><span class="mf">0.7</span><span class="o">.</span><span class="mf">0.</span><span class="n">dev0</span><span class="o">&lt;/</span><span class="n">version</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">segmentation</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="section" id="setting-segmentation-metadata">
<h3><a class="toc-backref" href="#id15">Setting Segmentation Metadata</a><a class="headerlink" href="#setting-segmentation-metadata" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># segmentation name</span>
<span class="n">seg</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;A New Segmentation&#39;</span>

<span class="c1"># segmentation software used</span>
<span class="n">seg</span><span class="o">.</span><span class="n">software</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">SFFSoftware</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Some Software&#39;</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">version</span><span class="o">=</span><span class="s1">&#39;v0.1.3.dev3&#39;</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">processingDetails</span><span class="o">=</span><span class="s1">&#39;Lorem ipsum dolor...&#39;</span>
<span class="o">...</span>     <span class="p">)</span>

<span class="c1"># bounding box</span>
<span class="n">seg</span><span class="o">.</span><span class="n">bounding_box</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">SFFBoundingBox</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">xmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">xmax</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">ymax</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">zmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">zmax</span><span class="o">=</span><span class="mi">256</span>
<span class="o">...</span>     <span class="p">)</span>

<span class="c1"># an identity matrix with no transformation</span>
<span class="n">transform</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">SFFTransformationMatrix</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">rows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">cols</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">data</span><span class="o">=</span><span class="s1">&#39;1 0 0 0 0 1 0 0 0 0 1 0&#39;</span>
<span class="o">...</span>     <span class="p">)</span>

<span class="c1"># add it to the list of transforms</span>
<span class="n">seg</span><span class="o">.</span><span class="n">transforms</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">SFFTransformList</span><span class="p">()</span>
<span class="n">seg</span><span class="o">.</span><span class="n">transforms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">transform</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="setting-segments">
<h4><a class="toc-backref" href="#id16">Setting Segments</a><a class="headerlink" href="#setting-segments" title="Permalink to this headline">¶</a></h4>
<div class="section" id="setting-segment-metadata">
<h5><a class="toc-backref" href="#id17">Setting Segment Metadata</a><a class="headerlink" href="#setting-segment-metadata" title="Permalink to this headline">¶</a></h5>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">segment</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">SFFSegment</span><span class="p">()</span>
</pre></div>
</div>
<div class="section" id="id1">
<h6><a class="toc-backref" href="#id18">Biological Annotation</a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h6>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># define the biological annotation object</span>
<span class="n">bioAnn</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">SFFBiologicalAnnotation</span><span class="p">()</span>
<span class="n">bioAnn</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Segment name&quot;</span>
<span class="n">bioAnn</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;Some description&quot;</span>
<span class="n">bioAnn</span><span class="o">.</span><span class="n">number_ofInstances</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># define the external references</span>
<span class="n">extRefs</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">SFFExternalReferences</span><span class="p">()</span>
<span class="n">extRefs</span><span class="o">.</span><span class="n">add_external_reference</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">schema</span><span class="o">.</span><span class="n">SFFExternalReference</span><span class="p">(</span>
<span class="o">...</span>         <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;ncbitaxon&quot;</span><span class="p">,</span>
<span class="o">...</span>         <span class="n">otherType</span><span class="o">=</span><span class="s2">&quot;http://purl.obolibrary.org/obo/NCBITaxon_559292&quot;</span><span class="p">,</span>
<span class="o">...</span>         <span class="n">value</span><span class="o">=</span><span class="s2">&quot;NCBITaxon_559292&quot;</span><span class="p">,</span>
<span class="o">...</span>         <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Saccharomyces cerevisiae S288C&quot;</span><span class="p">,</span>
<span class="o">...</span>         <span class="n">description</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="o">...</span>         <span class="p">)</span>
<span class="o">...</span>     <span class="p">)</span>
<span class="n">extRefs</span><span class="o">.</span><span class="n">add_external_reference</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">schema</span><span class="o">.</span><span class="n">SFFExternalReference</span><span class="p">(</span>
<span class="o">...</span>         <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;pdb&quot;</span><span class="p">,</span>
<span class="o">...</span>         <span class="n">otherType</span><span class="o">=</span><span class="s2">&quot;http://www.ebi.ac.uk/pdbe/entry/pdb/3ja8&quot;</span><span class="p">,</span>
<span class="o">...</span>         <span class="n">value</span><span class="o">=</span><span class="s2">&quot;3ja8&quot;</span><span class="p">,</span>
<span class="o">...</span>         <span class="n">label</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="o">...</span>         <span class="n">description</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="o">...</span>         <span class="p">)</span>
<span class="o">...</span>     <span class="p">)</span>
<span class="c1"># add the external references to the biological annotation</span>
<span class="n">bioAnn</span><span class="o">.</span><span class="n">external_references</span> <span class="o">=</span> <span class="n">extRefs</span>

<span class="c1"># add the biological annotation to the segment</span>
<span class="n">segment</span><span class="o">.</span><span class="n">biological_annotation</span> <span class="o">=</span> <span class="n">bioAnn</span>
</pre></div>
</div>
</div>
<div class="section" id="id2">
<h6><a class="toc-backref" href="#id19">Complexes and Macromolecules</a><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h6>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">compMacr</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">SFFComplexesAndMacromolecules</span><span class="p">()</span>
<span class="c1"># complexes</span>
<span class="n">comp</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">SFFComplexes</span><span class="p">()</span>
<span class="n">comp</span><span class="o">.</span><span class="n">add_complex</span><span class="p">(</span><span class="s2">&quot;comp1&quot;</span><span class="p">)</span>
<span class="n">comp</span><span class="o">.</span><span class="n">add_complex</span><span class="p">(</span><span class="s2">&quot;comp2&quot;</span><span class="p">)</span>

<span class="c1"># macromolecules</span>
<span class="n">macr</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">SFFMacromolecules</span><span class="p">()</span>
<span class="n">macr</span><span class="o">.</span><span class="n">add_macromolecule</span><span class="p">(</span><span class="s2">&quot;macr1&quot;</span><span class="p">)</span>
<span class="n">macr</span><span class="o">.</span><span class="n">add_macromolecule</span><span class="p">(</span><span class="s2">&quot;macr2&quot;</span><span class="p">)</span>

<span class="c1"># add the complexes and macromolecules</span>
<span class="n">compMacr</span><span class="o">.</span><span class="n">complexes</span> <span class="o">=</span> <span class="n">comp</span>
<span class="n">compMacr</span><span class="o">.</span><span class="n">macromolecules</span> <span class="o">=</span> <span class="n">macr</span>

<span class="c1"># add them to the segment</span>
<span class="n">segment</span><span class="o">.</span><span class="n">complexes_and_macromolecules</span> <span class="o">=</span> <span class="n">compMacr</span>
</pre></div>
</div>
</div>
<div class="section" id="colour">
<h6><a class="toc-backref" href="#id20">Colour</a><a class="headerlink" href="#colour" title="Permalink to this headline">¶</a></h6>
<p>Colours should be described using normalised RGBA values (each channel has a value in the interval [0,1]).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">segment</span><span class="o">.</span><span class="n">colour</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">SFFRGBA</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">red</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">green</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">blue</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span>
<span class="o">...</span> <span class="p">)</span>
<span class="n">segment</span><span class="o">.</span><span class="n">colour</span>
<span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="setting-mesh-segments">
<h5><a class="toc-backref" href="#id21">Setting Mesh Segments</a><a class="headerlink" href="#setting-mesh-segments" title="Permalink to this headline">¶</a></h5>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">random</span><span class="p">,</span> <span class="n">randint</span><span class="p">,</span> <span class="n">choice</span>

<span class="c1"># the list of meshes</span>
<span class="o">...</span>
<span class="n">meshes</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">SFFMeshList</span><span class="p">()</span>

<span class="c1"># a mesh</span>
<span class="o">...</span>
<span class="n">mesh</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">SFFMesh</span><span class="p">()</span>

<span class="c1"># a list of vertices</span>
<span class="o">...</span>
<span class="n">vertices</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">SFFVertexList</span><span class="p">()</span>
<span class="n">no_vertices</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1"># add vertices from the list of vertices</span>
<span class="o">...</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">no_vertices</span><span class="p">):</span>
<span class="o">...</span>     <span class="n">vertex</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">SFFVertex</span><span class="p">()</span>
<span class="o">...</span>     <span class="n">vertex</span><span class="o">.</span><span class="n">point</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
<span class="o">...</span>     <span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="p">(</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">),</span> <span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">),</span> <span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))))</span>
<span class="o">...</span>     <span class="n">vertices</span><span class="o">.</span><span class="n">add_vertex</span><span class="p">(</span><span class="n">vertex</span><span class="p">)</span>
<span class="o">...</span>
<span class="c1"># a list of polygons</span>
<span class="o">...</span>
<span class="n">polygons</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">SFFPolygonList</span><span class="p">()</span>
<span class="n">no_polygons</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1"># add polygons to the list of polygons</span>
<span class="o">...</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">no_polygons</span><span class="p">):</span>
<span class="o">...</span>     <span class="n">polygon</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">SFFPolygon</span><span class="p">()</span>
<span class="o">...</span>     <span class="n">polygon</span><span class="o">.</span><span class="n">add_vertex</span><span class="p">(</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))))</span>
<span class="o">...</span>     <span class="n">polygon</span><span class="o">.</span><span class="n">add_vertex</span><span class="p">(</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))))</span>
<span class="o">...</span>     <span class="n">polygon</span><span class="o">.</span><span class="n">add_vertex</span><span class="p">(</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))))</span>
<span class="o">...</span>     <span class="n">polygons</span><span class="o">.</span><span class="n">add_polygon</span><span class="p">(</span><span class="n">polygon</span><span class="p">)</span>
<span class="o">...</span>
<span class="c1"># set the vertices and polygons on the mesh</span>
<span class="o">...</span>
<span class="n">mesh</span><span class="o">.</span><span class="n">vertices</span> <span class="o">=</span> <span class="n">vertices</span>
<span class="n">mesh</span><span class="o">.</span><span class="n">polygons</span> <span class="o">=</span> <span class="n">polygons</span>

<span class="c1"># add the mesh to the list of meshes</span>
<span class="o">...</span>
<span class="n">meshes</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>

<span class="c1"># add the mesh to the segment</span>
<span class="o">...</span>
<span class="n">segment</span><span class="o">.</span><span class="n">meshes</span> <span class="o">=</span> <span class="n">meshes</span>
<span class="n">segment</span><span class="o">.</span><span class="n">meshes</span>
<span class="n">meshList</span>
<span class="nb">len</span><span class="p">(</span><span class="n">segment</span><span class="o">.</span><span class="n">meshes</span><span class="p">)</span>
<span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="section" id="setting-shape-segments">
<h5><a class="toc-backref" href="#id22">Setting Shape Segments</a><a class="headerlink" href="#setting-shape-segments" title="Permalink to this headline">¶</a></h5>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">random</span>

<span class="c1"># a list of shape</span>
<span class="n">shapes</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">SFFShapePrimitiveList</span><span class="p">()</span>

<span class="c1"># a cone</span>
<span class="c1"># first we define the transform that locates it in place</span>
<span class="n">transform</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">SFFTransformationMatrix</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">rows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">cols</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">data</span><span class="o">=</span><span class="s1">&#39;1 0 0 0 0 1 0 0 0 0 1 0&#39;</span>
<span class="o">...</span> <span class="p">)</span>

<span class="c1"># second we define its dimension</span>
<span class="n">shapes</span><span class="o">.</span><span class="n">add_shape</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">schema</span><span class="o">.</span><span class="n">SFFCone</span><span class="p">(</span>
<span class="o">...</span>         <span class="n">height</span><span class="o">=</span><span class="n">random</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span>
<span class="o">...</span>         <span class="n">bottomRadius</span><span class="o">=</span><span class="n">random</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span>
<span class="o">...</span>         <span class="n">transformId</span><span class="o">=</span><span class="n">transform</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
<span class="o">...</span>     <span class="p">)</span>
<span class="o">...</span> <span class="p">)</span>

<span class="c1"># add the transform to the list of transforms</span>
<span class="n">seg</span><span class="o">.</span><span class="n">transforms</span><span class="o">.</span><span class="n">add_transform</span><span class="p">(</span><span class="n">transform</span><span class="p">)</span>

<span class="c1"># a cuboid</span>
<span class="n">transform</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">SFFTransformationMatrix</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">rows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">cols</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">data</span><span class="o">=</span><span class="s1">&#39;2 0 0 0 5 3 0 0 27 0 0 1 9&#39;</span>
<span class="o">...</span> <span class="p">)</span>
<span class="n">shapes</span><span class="o">.</span><span class="n">add_shape</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">schema</span><span class="o">.</span><span class="n">SFFCuboid</span><span class="p">(</span>
<span class="o">...</span>         <span class="n">x</span><span class="o">=</span><span class="n">random</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span>
<span class="o">...</span>         <span class="n">y</span><span class="o">=</span><span class="n">random</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span>
<span class="o">...</span>         <span class="n">z</span><span class="o">=</span><span class="n">random</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span>
<span class="o">...</span>         <span class="n">transformId</span><span class="o">=</span><span class="n">transform</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
<span class="o">...</span>     <span class="p">)</span>
<span class="o">...</span> <span class="p">)</span>

<span class="c1"># add the transform to the list of transforms</span>
<span class="n">seg</span><span class="o">.</span><span class="n">transforms</span><span class="o">.</span><span class="n">add_transform</span><span class="p">(</span><span class="n">transform</span><span class="p">)</span>

<span class="c1"># a cylinder</span>
<span class="n">transform</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">SFFTransformationMatrix</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">rows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">cols</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">data</span><span class="o">=</span><span class="s1">&#39;2 0 0 0 15 3 0 0 17 0 0 1 16&#39;</span>
<span class="o">...</span> <span class="p">)</span>
<span class="n">shapes</span><span class="o">.</span><span class="n">add_shape</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">schema</span><span class="o">.</span><span class="n">SFFCylinder</span><span class="p">(</span>
<span class="o">...</span>         <span class="n">height</span><span class="o">=</span><span class="n">random</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span>
<span class="o">...</span>         <span class="n">diameter</span><span class="o">=</span><span class="n">random</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span>
<span class="o">...</span>         <span class="n">transformId</span><span class="o">=</span><span class="n">transform</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
<span class="o">...</span>     <span class="p">)</span>
<span class="o">...</span> <span class="p">)</span>

<span class="c1"># add the transform to the list of transforms</span>
<span class="n">seg</span><span class="o">.</span><span class="n">transforms</span><span class="o">.</span><span class="n">add_transform</span><span class="p">(</span><span class="n">transform</span><span class="p">)</span>

<span class="c1"># an ellipsoid</span>
<span class="n">transform</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">SFFTransformationMatrix</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">rows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">cols</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">data</span><span class="o">=</span><span class="s1">&#39;1 0 0 0 15 1 0 0 17 0 0 1 16&#39;</span>
<span class="o">...</span> <span class="p">)</span>
<span class="n">shapes</span><span class="o">.</span><span class="n">add_shape</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">schema</span><span class="o">.</span><span class="n">SFFEllipsoid</span><span class="p">(</span>
<span class="o">...</span>         <span class="n">x</span><span class="o">=</span><span class="n">random</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span>
<span class="o">...</span>         <span class="n">y</span><span class="o">=</span><span class="n">random</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span>
<span class="o">...</span>         <span class="n">z</span><span class="o">=</span><span class="n">random</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span>
<span class="o">...</span>         <span class="n">transformId</span><span class="o">=</span><span class="n">transform</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
<span class="o">...</span>     <span class="p">)</span>
<span class="o">...</span> <span class="p">)</span>

<span class="c1"># add the transform to the list of transforms</span>
<span class="n">seg</span><span class="o">.</span><span class="n">transforms</span><span class="o">.</span><span class="n">add_transform</span><span class="p">(</span><span class="n">transform</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="setting-volume-segments">
<h5><a class="toc-backref" href="#id23">Setting Volume Segments</a><a class="headerlink" href="#setting-volume-segments" title="Permalink to this headline">¶</a></h5>
<p>Working with 3D volumes consists of two steps:</p>
<ul class="simple">
<li><p>first, we need to define the volumes that contain the actual volume data as a set of <a class="reference internal" href="schema.html#sfftkrw.schema.adapter.SFFLattice" title="sfftkrw.schema.adapter.SFFLattice"><code class="xref py py-class docutils literal notranslate"><span class="pre">sfftkrw.schema.adapter.SFFLattice</span></code></a> objects contained in a <a class="reference internal" href="schema.html#sfftkrw.schema.adapter.SFFLatticeList" title="sfftkrw.schema.adapter.SFFLatticeList"><code class="xref py py-class docutils literal notranslate"><span class="pre">sfftkrw.schema.adapter.SFFLatticeList</span></code></a>;</p></li>
<li><p>next, we reference the lattice by specifying how the segment is associated with the lattice e.g. by contour level or voxel value using a <a class="reference internal" href="schema.html#sfftkrw.schema.adapter.SFFThreeDVolume" title="sfftkrw.schema.adapter.SFFThreeDVolume"><code class="xref py py-class docutils literal notranslate"><span class="pre">sfftkrw.schema.adapter.SFFThreeDVolume</span></code></a> object contained in a <a class="reference internal" href="schema.html#sfftkrw.schema.adapter.SFFSegment" title="sfftkrw.schema.adapter.SFFSegment"><code class="xref py py-class docutils literal notranslate"><span class="pre">sfftkrw.schema.adapter.SFFSegment</span></code></a> object as a <code class="docutils literal notranslate"><span class="pre">volume</span></code> attribute i.e. if <code class="docutils literal notranslate"><span class="pre">segment</span></code> is a <a class="reference internal" href="schema.html#sfftkrw.schema.adapter.SFFSegment" title="sfftkrw.schema.adapter.SFFSegment"><code class="xref py py-class docutils literal notranslate"><span class="pre">sfftkrw.schema.adapter.SFFSegment</span></code></a> object then <code class="docutils literal notranslate"><span class="pre">segment.volume</span></code> will be a <a class="reference internal" href="schema.html#sfftkrw.schema.adapter.SFFThreeDVolume" title="sfftkrw.schema.adapter.SFFThreeDVolume"><code class="xref py py-class docutils literal notranslate"><span class="pre">sfftkrw.schema.adapter.SFFThreeDVolume</span></code></a> object and we say that <code class="docutils literal notranslate"><span class="pre">segment</span></code> contains a <code class="docutils literal notranslate"><span class="pre">threeDVolume</span></code> segment representation.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="c1"># lattice 1</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="c1"># lattice container</span>
<span class="n">lattices</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">SFFLatticeList</span><span class="p">()</span>

<span class="c1"># lattice 1</span>
<span class="n">binlist</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span> <span class="o">*</span> <span class="mi">20</span> <span class="o">*</span> <span class="mi">20</span><span class="p">)])</span>
<span class="n">lattice</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">SFFLattice</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;uint32&#39;</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">endianness</span><span class="o">=</span><span class="s1">&#39;little&#39;</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">size</span><span class="o">=</span><span class="n">schema</span><span class="o">.</span><span class="n">SFFVolumeStructure</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">sections</span><span class="o">=</span><span class="mi">20</span><span class="p">),</span>
<span class="o">...</span>     <span class="n">start</span><span class="o">=</span><span class="n">schema</span><span class="o">.</span><span class="n">SFFVolumeIndex</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sections</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
<span class="o">...</span>     <span class="n">data</span><span class="o">=</span><span class="n">binlist</span><span class="p">,</span>
<span class="o">...</span> <span class="p">)</span>
<span class="n">lattices</span><span class="o">.</span><span class="n">add_lattice</span><span class="p">(</span><span class="n">lattice</span><span class="p">)</span>
<span class="n">lattices</span>
<span class="n">Container</span> <span class="k">for</span> <span class="mi">3</span><span class="n">D</span> <span class="n">lattices</span>
<span class="n">binlist</span>
<span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">binlist</span><span class="o">.</span><span class="n">shape</span>
<span class="p">(</span><span class="mi">8000</span><span class="p">,)</span>
<span class="n">lattice</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">SFFLattice</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;uint32&#39;</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">endianness</span><span class="o">=</span><span class="s1">&#39;little&#39;</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">size</span><span class="o">=</span><span class="n">schema</span><span class="o">.</span><span class="n">SFFVolumeStructure</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">sections</span><span class="o">=</span><span class="mi">20</span><span class="p">),</span>
<span class="o">...</span>     <span class="n">start</span><span class="o">=</span><span class="n">schema</span><span class="o">.</span><span class="n">SFFVolumeIndex</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sections</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
<span class="o">...</span>     <span class="n">data</span><span class="o">=</span><span class="n">binlist</span><span class="p">,</span>
<span class="o">...</span> <span class="p">)</span>
<span class="n">lattice</span>
<span class="mi">3</span><span class="n">D</span> <span class="n">lattice</span>
<span class="n">lattice</span><span class="o">.</span><span class="n">mode</span>
<span class="s1">&#39;uint32&#39;</span>
<span class="n">lattice</span><span class="o">.</span><span class="n">endianness</span>
<span class="s1">&#39;little&#39;</span>
<span class="n">lattice</span><span class="o">.</span><span class="n">size</span>
<span class="mi">3</span><span class="n">D</span> <span class="n">volume</span> <span class="n">structure</span><span class="p">:</span> <span class="n">cols</span><span class="p">,</span> <span class="n">rows</span><span class="p">,</span> <span class="n">sections</span>
<span class="n">lattice</span><span class="o">.</span><span class="n">start</span>
<span class="mi">3</span><span class="n">D</span> <span class="n">volume</span> <span class="n">start</span> <span class="n">index</span><span class="p">:</span> <span class="n">cols</span><span class="p">,</span> <span class="n">rows</span><span class="p">,</span> <span class="n">sections</span>
<span class="c1"># the lattice data is base64 encoded</span>
<span class="n">lattice</span><span class="o">.</span><span class="n">data</span>
<span class="s1">&#39;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&#39;</span>

<span class="c1"># lattice 2</span>
<span class="n">binlist2</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">*</span> <span class="mi">100</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">30</span> <span class="o">*</span> <span class="mi">40</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)])</span>
<span class="n">lattice2</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">SFFLattice</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;float32&#39;</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">endianness</span><span class="o">=</span><span class="s1">&#39;big&#39;</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">size</span><span class="o">=</span><span class="n">schema</span><span class="o">.</span><span class="n">SFFVolumeStructure</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">sections</span><span class="o">=</span><span class="mi">50</span><span class="p">),</span>
<span class="o">...</span>     <span class="n">start</span><span class="o">=</span><span class="n">schema</span><span class="o">.</span><span class="n">SFFVolumeIndex</span><span class="p">(</span><span class="n">cols</span><span class="o">=-</span><span class="mi">50</span><span class="p">,</span> <span class="n">rows</span><span class="o">=-</span><span class="mi">40</span><span class="p">,</span> <span class="n">sections</span><span class="o">=</span><span class="mi">100</span><span class="p">),</span>
<span class="o">...</span>     <span class="n">data</span><span class="o">=</span><span class="n">binlist2</span><span class="p">,</span>
<span class="o">...</span> <span class="p">)</span>
<span class="n">lattices</span><span class="o">.</span><span class="n">add_lattice</span><span class="p">(</span><span class="n">lattice2</span><span class="p">)</span>

<span class="n">lattices</span>
<span class="n">Container</span> <span class="k">for</span> <span class="mi">3</span><span class="n">D</span> <span class="n">lattices</span>
<span class="nb">len</span><span class="p">(</span><span class="n">lattices</span><span class="p">)</span>
<span class="mi">2</span>

<span class="c1"># now we define the segments that reference the lattices above</span>
<span class="c1"># segments</span>
<span class="n">segments</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">SFFSegmentList</span><span class="p">()</span>

<span class="c1"># segment one</span>
<span class="n">segment</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">SFFSegment</span><span class="p">()</span>
<span class="n">vol1_value</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">segment</span><span class="o">.</span><span class="n">volume</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">SFFThreeDVolume</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">latticeId</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">value</span><span class="o">=</span><span class="n">vol1_value</span><span class="p">,</span>
<span class="o">...</span> <span class="p">)</span>
<span class="n">segment</span><span class="o">.</span><span class="n">colour</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">SFFRGBA</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">red</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(),</span>
<span class="o">...</span>     <span class="n">green</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(),</span>
<span class="o">...</span>     <span class="n">blue</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(),</span>
<span class="o">...</span>     <span class="n">alpha</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
<span class="o">...</span> <span class="p">)</span>
<span class="n">segments</span><span class="o">.</span><span class="n">add_segment</span><span class="p">(</span><span class="n">segment</span><span class="p">)</span>

<span class="c1"># segment two</span>
<span class="n">segment</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">SFFSegment</span><span class="p">()</span>
<span class="n">vol2_value</span> <span class="o">=</span> <span class="mf">37.1</span>
<span class="n">segment</span><span class="o">.</span><span class="n">volume</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">SFFThreeDVolume</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">latticeId</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="o">...</span>     <span class="n">value</span><span class="o">=</span><span class="n">vol2_value</span>
<span class="o">...</span> <span class="p">)</span>
<span class="n">segment</span><span class="o">.</span><span class="n">colour</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">SFFRGBA</span><span class="p">(</span>
<span class="o">...</span>     <span class="n">red</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(),</span>
<span class="o">...</span>     <span class="n">green</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(),</span>
<span class="o">...</span>     <span class="n">blue</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(),</span>
<span class="o">...</span>     <span class="n">alpha</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
<span class="o">...</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="adding-a-segment-to-the-segmentation">
<h5><a class="toc-backref" href="#id24">Adding A Segment To The Segmentation</a><a class="headerlink" href="#adding-a-segment-to-the-segmentation" title="Permalink to this headline">¶</a></h5>
<p>Once we have added the individual segment representations to the respective segments we can add the segment to the
segmentation. The list of segments is contained in a <a class="reference internal" href="schema.html#sfftkrw.schema.adapter.SFFSegmentList" title="sfftkrw.schema.adapter.SFFSegmentList"><code class="xref py py-class docutils literal notranslate"><span class="pre">sfftkrw.schema.adapter.SFFSegmentList</span></code></a> object.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># create the list of segments</span>
<span class="n">seg</span><span class="o">.</span><span class="n">segments</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">SFFSegmentList</span><span class="p">()</span>

<span class="c1"># add the segment</span>
<span class="n">seg</span><span class="o">.</span><span class="n">segments</span><span class="o">.</span><span class="n">add_segment</span><span class="p">(</span><span class="n">segment</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="exporting-emdb-sff-objects">
<h2><a class="toc-backref" href="#id25">Exporting EMDB-SFF Objects</a><a class="headerlink" href="#exporting-emdb-sff-objects" title="Permalink to this headline">¶</a></h2>
<p>Finally, after completing the segmentation we can export it to disk as a file. The <code class="xref py py-meth docutils literal notranslate"><span class="pre">sfftkrw.schema.adapter.SFFType.export()</span></code> method infers the output file type from from the file extension.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># XML</span>
<span class="n">seg</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="s1">&#39;file.sff&#39;</span><span class="p">)</span>

<span class="c1"># HDF5</span>
<span class="n">seg</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="s1">&#39;file.hff&#39;</span><span class="p">)</span>

<span class="c1"># JSON</span>
<span class="n">seg</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="s1">&#39;file.json&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="navigating-your-way-through-a-segmentation">
<h2><a class="toc-backref" href="#id26">Navigating Your Way Through A Segmentation</a><a class="headerlink" href="#navigating-your-way-through-a-segmentation" title="Permalink to this headline">¶</a></h2>
<div class="section" id="iterating">
<h3><a class="toc-backref" href="#id27">Iterating</a><a class="headerlink" href="#iterating" title="Permalink to this headline">¶</a></h3>
<div class="section" id="segments">
<h4><a class="toc-backref" href="#id28">Segments</a><a class="headerlink" href="#segments" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">segment</span> <span class="ow">in</span> <span class="n">seg</span><span class="o">.</span><span class="n">segments</span><span class="p">:</span>
    <span class="c1"># do something with segment</span>
<span class="o">...</span>     <span class="k">print</span><span class="p">(</span><span class="n">segment</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">segment</span><span class="o">.</span><span class="n">parentID</span><span class="p">)</span>
<span class="o">...</span>
<span class="mi">2</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
<div class="section" id="meshes">
<h4><a class="toc-backref" href="#id29">Meshes</a><a class="headerlink" href="#meshes" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">mesh</span> <span class="ow">in</span> <span class="n">segment</span><span class="o">.</span><span class="n">meshes</span><span class="p">:</span>
<span class="o">...</span>     <span class="k">for</span> <span class="n">vertex</span> <span class="ow">in</span> <span class="n">mesh</span><span class="o">.</span><span class="n">vertices</span><span class="p">:</span>
<span class="o">...</span>         <span class="k">print</span><span class="p">(</span><span class="n">vertex</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<span class="o">...</span>         <span class="k">print</span><span class="p">(</span><span class="n">vertex</span><span class="o">.</span><span class="n">designation</span><span class="p">)</span> <span class="c1"># &#39;surface&#39; or &#39;normal&#39;</span>
<span class="o">...</span>         <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">vertex</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">vertex</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">vertex</span><span class="o">.</span><span class="n">z</span>
<span class="o">...</span>
<span class="o">...</span>     <span class="k">for</span> <span class="n">polygon</span> <span class="ow">in</span> <span class="n">mesh</span><span class="o">.</span><span class="n">polygons</span><span class="p">:</span>
<span class="o">...</span>         <span class="k">print</span><span class="p">(</span><span class="n">polygon</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<span class="o">...</span>         <span class="k">print</span><span class="p">(</span><span class="n">polygon</span><span class="o">.</span><span class="n">vertex_ids</span><span class="p">)</span>
<span class="o">...</span>
</pre></div>
</div>
</div>
<div class="section" id="external-references">
<h4><a class="toc-backref" href="#id30">External References</a><a class="headerlink" href="#external-references" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">extRef</span> <span class="ow">in</span> <span class="n">segment</span><span class="o">.</span><span class="n">biological_annotation</span><span class="o">.</span><span class="n">externalReferences</span><span class="p">:</span>
<span class="o">...</span>     <span class="k">print</span><span class="p">(</span><span class="n">extRef</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
<span class="o">...</span>     <span class="k">print</span><span class="p">(</span><span class="n">extRef</span><span class="o">.</span><span class="n">otherType</span><span class="p">)</span>
<span class="o">...</span>     <span class="k">print</span><span class="p">(</span><span class="n">extRef</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<span class="o">...</span>     <span class="k">print</span><span class="p">(</span><span class="n">extRef</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>
<span class="o">...</span>     <span class="k">print</span><span class="p">(</span><span class="n">extRef</span><span class="o">.</span><span class="n">description</span><span class="p">)</span>
<span class="o">...</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="sfftk-rw.html" class="btn btn-neutral float-right" title="sfftk packages" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="misc.html" class="btn btn-neutral float-left" title="Miscellaneous Operations Using sfftk-rw" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, EMBL-EBI

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>